### <a name="_b7urdng99y53"></a>**Название задачи:** 
ADR-002: Интеграция передачи депозитных ставок в системы кол-центра
### <a name="_hjk0fkfyohdk"></a>**Автор:**
Команда цифровой трансформации
### <a name="_uanumrh8zrui"></a>**Дата:**
13.02.2026
### <a name="_3bfxc9a45514"></a>**Функциональные требования**
Здесь описаны верхнеуровневые Use Cases. Они оформлены в виде таблицы с пошаговым описанием:

| **№** | **Действующие лица или системы**                                                        | **Use Case**                                     | **Описание**                                                                                                                                                                                                                                                         |
|:-----:|:----------------------------------------------------------------------------------------|:-------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  UC1  | Сотрудник кол-центра, Система кол-центра, Сервис депозитных заявок                      | Консультация по актуальным ставкам               | 1. Клиент звонит в кол-центр для уточнения условий депозита<br>2. Сотрудник кол-центра открывает справочник ставок в своей системе<br>3. Система кол-центра отображает актуальные ставки по депозитам<br>4. Сотрудник консультирует клиента по доступным ставкам     |
|  UC2  | Сотрудник партнерского кол-центра, Система партнерского кол-центра, SFTP-сервер         | Консультация по ставкам в партнерском кол-центре | 1. Клиент звонит в партнерский кол-центр<br>2. Сотрудник партнерского кол-центра проверяет последний файл со ставками<br>3. Система партнерского кол-центра отображает ставки из загруженного файла<br>4. Сотрудник предоставляет консультацию по актуальным ставкам |
|  UC3  | Система автоматического обновления ставок, Сервис депозитных заявок, Система кол-центра | Обновление ставок в системе кол-центра           | 1. Бэк-офис обновляет ставки в Excel-файле<br>2. Сервис депозитных заявок получает обновленные ставки<br>3. Сервис передает актуальные ставки в систему кол-центра через API<br>4. Система кол-центра обновляет справочник ставок                                    |
|  UC4  | Система автоматического обновления ставок, Сервис депозитных заявок, SFTP-сервер        | Обновление ставок для партнерского кол-центра    | 1. Бэк-офис обновляет ставки в Excel-файле<br>2. Сервис депозитных заявок получает обновленные ставки<br>3. Сервис формирует файл со ставками и передает его на SFTP-сервер<br>4. Партнерский кол-центр забирает файл и обновляет свою систему                       |

### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**
Здесь описаны нефункциональные требования и архитектурно значимые требования.

| **№** | **Требование**                                                                                                     |
|:-----:|:-------------------------------------------------------------------------------------------------------------------|
|  R1   | Актуальность данных: ставки должны обновляться в системах кол-центра не позднее чем через 30 минут после изменения |
|  R2   | Доступность систем кол-центра для консультаций 24/7                                                                |
|  P1   | Время отклика API для получения ставок не более 2 секунд                                                           |
|  P2   | Размер файла со ставками не должен превышать 1 МБ                                                                  |
|  +R1  | Безопасность: передача ставок должна осуществляться по защищенным каналам связи                                    |
|  +R2  | Совместимость с существующей системой кол-центра (Java / Spring Boot)                                              |
|  +R3  | Использование SFTP-протокола для партнерского кол-центра (нет возможности API-интеграции)                          |
|  +R4  | Минимизация изменений в существующих системах                                                                      |
|  +R5  | Возможность масштабирования на несколько партнерских кол-центров                                                   |

### <a name="_qmphm5d6rvi3"></a>**Решение**
Для решения задачи передачи депозитных ставок в системы кол-центра создается дополнительный функционал в рамках существующего «Сервиса депозитных заявок». Данное решение расширяет текущую архитектуру новыми интеграциями без нарушения существующего функционала.

#### [Диаграмма контекста C4]()

Диаграмма контекста демонстрирует взаимодействие систем кол-центра с сервисом депозитных заявок для получения актуальных ставок.

#### [Диаграмма контейнеров C4]()

На уровне контейнеров показано, как расширяется существующий сервис депозитных заявок новыми компонентами для работы со ставками.

#### Логика принятия решений и выбор технологий:

- Расширение существующего сервиса: вместо создания отдельного сервиса для ставок мы расширяем функционал существующего сервиса депозитных заявок. Это минимизирует архитектурную сложность и использует уже настроенную инфраструктуру.
- Двойная интеграция: для внутреннего кол-центра используется REST API (соответствует требованию +R2 о совместимости с Java Spring Boot), для партнерского кол-центра - SFTP файловый обмен (соответствует ограничению +R3).
- Автоматизация обновления: ставки автоматически обновляются в базе данных сервиса при получении новых данных от бэк-офиса, что обеспечивает актуальность данных (требование R1).
- Безопасность: Все интеграции используют защищенные протоколы - HTTPS для API и SFTP для файлового обмена (требование +R1).

### <a name="_bjrr7veeh80c"></a>**Альтернативы**
Здесь описаны наиболее важные альтернативные решения.

1. Создание отдельного микросервиса для управления ставками.
    - Причина отказа: увеличивает сложность архитектуры и требует дополнительной инфраструктуры для MVP. Противоречит требованию +R4 о минимизации изменений.
2. Прямая интеграция систем кол-центра с АБС.
    - Причина отказа: создает дополнительную нагрузку на перегруженную АБС и противоречит архитектурной стратегии изоляции фронтальных систем от внутренних.
3. Ручная рассылка ставок по email сотрудникам кол-центра
    - Причина отказа: Не обеспечивает автоматизацию процесса и актуальность данных, создает операционные риски.

**Недостатки, ограничения, риски**

- Зависимость от SFTP: партнерский кол-центр зависит от стабильности работы SFTP-сервера и своевременности загрузки файлов.
- Задержка обновления: у партнерского кол-центра может быть задержка в получении актуальных ставок по сравнению с внутренним кол-центром из-за файлового обмена.
- Формат файлов: необходимо согласовать и поддерживать единый формат файлов со ставками для всех партнерских кол-центров.
- Масштабирование: при увеличении количества партнерских кол-центров может потребоваться оптимизация процесса генерации и распространения файлов.
- Операционная сложность: требует мониторинга и поддержки дополнительных интеграционных процессов.

# Список крупных задач из ADR-002

| **№** | **Требования**                                                      | **Система**                     |
|:-----:|:--------------------------------------------------------------------|:--------------------------------|
|  T1   | Расширение модели данных                                            | Сервис депозитных заявок        |
|  T2   | Создание компонента получения ставок от бэк-офиса                   | Сервис депозитных заявок        |
|  T3   | Разработка Rates API для внутреннего кол-центра                     | Сервис депозитных заявок        |
|  T4   | Реализация функционала генерации файлов для партнерского кол-центра | Сервис депозитных заявок        |
|  T7   | Интеграция с Rates API                                              | Система кол-центра (внутренняя) |
|  T10  | Настройка SFTP-инфраструктуры                                       | SFTP-сервер                     |
|  T11  | Мониторинг и администрирование                                      | SFTP-сервер                     |
|  T12  | Разработка клиента для SFTP                                         | Система партнерского кол-центра |

